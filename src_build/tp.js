/*csd*//**
 * tp 3.0
 * tp 模板引擎，最简洁高效的js模板引擎
 * tp 可应用于Node.js，也可以在浏览器环境下使用。
 * 作者：侯锋
 * 邮箱：admin@xhou.net
 * 网站：http://houfeng.net , http://houfeng.net/tp
 */
(function(g){function f(j){j=j.replace(new RegExp("\\{1}","gim"),"\\\\");j=j.replace(new RegExp("\r{1}","gim"),"");j=j.replace(new RegExp("\n{1}","gim"),"\\n");j=j.replace(new RegExp("\r{1}","gim"),"\\r");j=j.replace(new RegExp('"{1}',"gim"),'\\"');return j;}function e(j){return j.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");}function i(k,l){try{return k();}catch(j){j.message=j.message||"";j.stack=j.stack||"";j.message=l+" : "+j.message+"\r\n    "+j.stack;throw j;}}var d={};function c(l,j){if(!l){return;}j=j||d;for(var k in l){j[k]=l[k];}}function b(j){var k=function(m){k.buffer.push(m);};for(var l in j){if(j[l]){c(j[l],k);}}return k;}function a(t,s){t=t||"";s=s||{};var k=s.codeBegin||g.codeBegin;var n=s.codeEnd||g.codeEnd;var l=new RegExp(k,"gim");var o=new RegExp(n,"gim");var p=new RegExp("("+k+"(.|\n|\r)*?"+n+")","gim");var j=["with($.model){"];var m=t.match(p);var u=t.replace(p,"▎").split("▎");for(var r=0;r<u.length;r++){j.push('$("'+f(u[r])+'");');if(m&&m[r]){j.push(m[r].replace(l,"").replace(o,"")+";");}}j.push('};return $.buffer.join("");');var q=function(x,v){var w=b([d,s.extend,v]);w.func=q;w.buffer=[];w.model=x||{};return i(function(){return(w.func.src.call(w.model,w)||"");},"Template execute error");};i(function(){q.src=new Function("$",j.join(""));},"Template compile error");return q;}g.codeBegin="<%";g.codeEnd="%>";g.extend=c;g.compile=function(k,j){return a(k,j);};g.parse=function(n,l,m,j){var k=a(n,m);return k(l,j);};if(typeof window!=="undefined"&&window.document){g.query=function(j){return window.document.getElementById(j);};var h={};g.bind=function(j){j=j||{};var k=j.query||g.query;j.el=j.el||j.element;j.el=(typeof j.el==="string")?k(j.el):j.el;j.tp=j.tp||j.template||j.el;j.tp=(typeof j.tp==="string")?(k(j.tp)||j.tp):j.tp;if(!j.tp||!j.el){return;}h[j.tp]=h[j.tp]||a(e(j.tp.innerHTML||j.tp),j);if(j.append){j.el.innerHTML+=h[j.tp](j.model);}else{j.el.innerHTML=h[j.tp](j.model);}};window.tp=g;}})((function(){var a=(typeof exports==="undefined")?{}:exports;if(typeof define==="function"&&define.amd){define("tp",[],function(){return a;});}return a;})());