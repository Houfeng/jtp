/*csd*//**
 * tp 3.1
 * tp 模板引擎，最简洁高效的js模板引擎
 * tp 可应用于Node.js，也可以在浏览器环境下使用。
 * 作者：侯锋
 * 邮箱：admin@xhou.net
 * 网站：http://houfeng.net , http://houfeng.net/tp
 */
(function(g){function f(j){if(!j){return"";}j=j.replace(new RegExp("\\{1}","gim"),"\\\\");j=j.replace(new RegExp("\r{1}","gim"),"");j=j.replace(new RegExp("\n{1}","gim"),"\\n");j=j.replace(new RegExp("\r{1}","gim"),"\\r");j=j.replace(new RegExp('"{1}',"gim"),'\\"');return j;}function e(j){if(!j){return"";}return j.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");}function i(k,l){try{return k();}catch(j){j.message=j.message||"";j.stack=j.stack||"";j.message=l+" : "+j.message+"\r\n    "+j.stack;throw j;}}var d={};function c(l,j){if(!l){return;}j=j||d;for(var k in l){j[k]=l[k];}}function b(k,n,j){var l=function(o){l.buffer.push(o);};for(var m in j){if(j[m]){c(j[m],l);}}l.func=k;l.model=n||{};l.buffer=[];return l;}function a(v,t){v=v||"";t=t||{};var k=t.codeBegin||g.codeBegin;var o=t.codeEnd||g.codeEnd;var l=new RegExp(k,"gim");var p=new RegExp(o,"gim");var q=new RegExp("("+k+"(.|\\\n|\\\r)*?"+o+")","gim");var u=new RegExp(k+"\\s*=","gim");var n=['"use strict"'];var m=v.match(q)||[];var x=v.replace(q,"▎").split("▎")||[];for(var s=0;s<x.length;s++){var w=f(x[s]);var j=m[s];n.push('$("'+w+'")');if(j!=null){if(u.test(j)){j="$("+j.replace(u,"").replace(p,"")+")";}else{j=j.replace(l,"").replace(p,"");}n.push(j);}}n.push('return $.buffer.join("");');var r=function(A,y){var z=b(r,A,[d,t.extend,y]);return i(function(){return(z.func.src.call(z.model,z,z.model)||"");},"Template execute error");};i(function(){r.src=new Function("$","$$",n.join(";"));},"Template compile error");return r;}g.codeBegin="<%";g.codeEnd="%>";g.extend=c;g.compile=function(k,j){return a(k,j);};g.parse=function(n,l,m,j){var k=a(n,m);return k(l,j);};if(typeof window!=="undefined"&&window.document){g.query=function(j){return window.document.getElementById(j);};var h={};g.bind=function(j){j=j||{};var k=j.query||g.query;j.el=j.el||j.element;j.el=(typeof j.el==="string")?k(j.el):j.el;j.tp=j.tp||j.template||j.el;j.tp=(typeof j.tp==="string")?(k(j.tp)||j.tp):j.tp;if(!j.tp||!j.el){return;}h[j.tp]=h[j.tp]||a(e(j.tp.innerHTML||j.tp),j);if(j.append){j.el.innerHTML+=h[j.tp](j.model);}else{j.el.innerHTML=h[j.tp](j.model);}};window.tp=g;}})((function(){var a=(typeof exports==="undefined")?{}:exports;if(typeof define==="function"&&define.amd){define("tp",[],function(){return a;});}return a;})());