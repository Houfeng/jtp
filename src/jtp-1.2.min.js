/**
 * jtp 1.2
 * jtp 模板引擎，最简洁高效的js模板引擎
 * jtp 可应用于Node.js，也可以在浏览器环境下使用。
 * 作者：侯锋
 * 邮箱：admin@xhou.net
 */

var jtp={};(function(a){a.helper={outTransferred:function(b){b=b.replace(new RegExp("\\{1}","gim"),"\\\\");b=b.replace(new RegExp("\r{1}","gim"),"");b=b.replace(new RegExp("\n{1}","gim"),"\\n");
b=b.replace(new RegExp('"{1}',"gim"),'\\"');return b;},inTransferred:function(b){return b.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");
},tryInvoke:function(c){try{return c();}catch(b){if(a.option.debugMode){throw b;}else{return b.description||b.message;}}}};a.option={debugMode:false,codeBegin:"{#",codeEnd:"#}"};
a.compile=function(b,k){b=b||"";k=k||{};k.codeBegin=k.codeBegin||a.option.codeBegin;k.codeEnd=k.codeEnd||a.option.codeEnd;var g=new RegExp(k.codeBegin,"gim");
var h=new RegExp(k.codeEnd,"gim");var c=new RegExp("("+k.codeBegin+"(.|\n)*?"+k.codeEnd+")","gim");var e=["var jtp={buffer:[],out:function(x){jtp.buffer.push(x);}};var $=jtp.out;"];
var l=b.match(c);var m=b.replace(c,"▎").split("▎");for(var f=0;f<m.length;f++){e.push('jtp.out("'+a.helper.outTransferred(m[f])+'");');if(l&&l[f]){e.push(l[f].replace(g,"").replace(h,"")+";");
}}e.push('return jtp.buffer.join("");');var j=function(){};a.helper.tryInvoke(function(){j=new Function(e.join(""));});var d=function(i){i=i||{};return a.helper.tryInvoke(function(){return j.call(i,i)||"";
});};d.src=j;return d;};a.parse=function(e,b,d){var c=a.compile(e,d);return c(b);};a.element=function(b,c){if(!b){return;}if(!b.jtp){b.jtp={};b.jtp.$exec=a.compile(a.helper.inTransferred(b.innerHTML),c);
b.innerHTML="";b.jtp.bind=function(d){b.innerHTML=b.jtp.$exec(d);};b.jtp.append=function(d){b.innerHTML+=b.jtp.$exec(d);};}return b.jtp;};})(typeof exports==="undefined"?jtp:exports);
